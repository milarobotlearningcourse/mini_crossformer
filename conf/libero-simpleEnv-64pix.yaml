defaults:
  - override hydra/launcher: MY_2HRS
  - _self_


hydra:
  launcher: 
    gres: gpu:a100 # 
    # gpus-per-task: rtx8000:1
    mem_gb: 32
    tasks_per_node: 1
    cpus_per_task: 8
    array_parallelism: 3 # I think this means run per job.
    additional_parameters:
      time: 0-03:00:00                               # maximum wall time allocated for the job (D-H:MM:SS)
      # mail-type: ARRAY_TASKS,FAIL,TIME_LIMIT         # events to notify user by email
      # mail-user: ???                                 # email of the user

experiment:
  name: mini_grp
  project: mini-grp
  
batch_size: 128 # how many independent sequences will we process in parallel?
max_block_size: 8 ## Will be overidden by code
vocab_size: 32 ## Will be overidden by code
n_patches: 8
patch_size: 8
max_iters: 50000
eval_interval: 100
learning_rate: 5e-5
eval_iters: 200
policy:
  action_stacking: 1
  obs_stacking: 2
  use_image_augmentations: false
  dtype: 'float32'

n_embd: 512
device: "cuda"
testing: true
eval_vid_iters: 2500
gradient_accumulation_steps: 2

simEval: ["simple_env", "libero"] # "simpler_env" or "libero"
sim:
  eval_episodes: 5
  eval_tasks: [9, 24, 30, 69]
  episode length: 500

# ------------

r_seed: 1337
n_head: 16
n_blocks: 4
dropout: 0.2
action_bins: 7
action_dim: 7
load_action_bounds: true
env:
  "action_std": [
      0.2755078673362732,
      0.352868914604187,
      0.3764951825141907,
      0.07468929141759872,
      0.08207540959119797,
      0.14809995889663696,
      1.3713711500167847
    ]
  "action_mean": [
      0.02461858280003071,
      0.022891279309988022,
      -0.045159097760915756,
      0.0011062328703701496,
      0.0019464065553620458,
      0.001989248674362898,
      -0.02906678058207035
    ]
  gripper_closed_std: 1.0

## Model hyperparameters
image_shape: [64, 64, 3]
data_shuffel_interval: 1000
dataset: 
  to_name: gberseth/libero-data-64px-full
  num_episodes: 20
  chunk_size: 20
  buffer_size: 5000
  encode_with_t5: true
  t5_version: "t5-small"
  chars_list:  [' ', ',', '.', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
   '!', '?', '"', "'", '(', ')', '-', '_', ':', ';',
   '@', '#', '$', '%', '&', '*', '+', '=', '<', '>', '/', '\\', '|', '~', '`',
   'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z', 
   'a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i', 'j', 'k', 'l', 'm', 'n', 'o', 'p', 'q', 'r', 's', 't', 'u', 'v', 'w', 'x', 'y', 'z']
  load_dataset: true
  save_initial_dataset: false
  dataset_indicies: {
    "/network/datasets/openxembodiment/datasets/bridge/0.1.0/": {"start": 11, size: 28935, weight: 0.3, dataset_key: "bridge_oxe", scale: 1.0},
    # "/network/datasets/openxembodiment/datasets/stanford_robocook_converted_externally_to_rlds/0.1.0": {"start": 0, size: 1000000, weight: 0.3, dataset_key: "stanford_robocook_converted_externally_to_rlds", scale: 1.0},
    "/network/datasets/openxembodiment/datasets/maniskill_dataset_converted_externally_to_rlds/0.1.0": {"start": 0, size: 1000000, weight: 0.3, dataset_key: "maniskill_dataset_converted_externally_to_rlds", scale: 1.0},
    "/network/projects/real-g-grp/modified_libero_rlds/libero_90_no_noops/1.0.0": {"start": 0, size: 1000000, weight: 0.3, dataset_key: "maniskill_dataset_converted_externally_to_rlds", scale: 1.0},
    # "gs://gresearch/robotics/bridge/0.1.0/": {start: 0, weight: 1.0, dataset_key: "bridge_oxe", scale: 1.0},
    # "gs://gresearch/robotics/stanford_robocook_converted_externally_to_rlds/0.1.0": {"start": 0, weight: 1.0, dataset_key: "stanford_robocook_converted_externally_to_rlds", scale: 1.0},
    # "gs://gresearch/robotics/maniskill_dataset_converted_externally_to_rlds/0.1.0": {start: 0, weight: 1.0, dataset_key: "maniskill_dataset_converted_externally_to_rlds", scale: 1.0},
    # "/network/datasets/openxembodiment/datasets/language_table/0.0.1": {"start": 0, size: 1000000, weight: 0.5, "image_key": "rgb", "text_key": "instruction"},  
    # "/network/datasets/openxembodiment/datasets/kuka/0.1.0": {"start": 0, size: 1000000, weight: 0.5, "image_key": "image", "text_key": "natural_language_instruction", "action_key": "gripper_closedness_action", scale: 0.1},  
  }
  
trim: 1000000
